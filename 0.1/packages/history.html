<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>History | UnoPim Documentation</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" type="image/png" href="/favicon.ico">
    <meta name="description" content="UnoPim Developer Portal">
    
    <link rel="preload" href="/assets/css/0.styles.d1829642.css" as="style"><link rel="preload" href="/assets/js/app.6d62f337.js" as="script"><link rel="preload" href="/assets/js/2.466c6646.js" as="script"><link rel="preload" href="/assets/js/1.4723c82d.js" as="script"><link rel="preload" href="/assets/js/65.0ccd7b6d.js" as="script"><link rel="prefetch" href="/assets/js/10.fed0cda8.js"><link rel="prefetch" href="/assets/js/100.43453e42.js"><link rel="prefetch" href="/assets/js/101.3ca69aa2.js"><link rel="prefetch" href="/assets/js/102.d8d5f5aa.js"><link rel="prefetch" href="/assets/js/103.20a97eeb.js"><link rel="prefetch" href="/assets/js/104.cccc9a4e.js"><link rel="prefetch" href="/assets/js/105.da24dae5.js"><link rel="prefetch" href="/assets/js/106.4f1a40d4.js"><link rel="prefetch" href="/assets/js/107.367819e1.js"><link rel="prefetch" href="/assets/js/108.0c8433fb.js"><link rel="prefetch" href="/assets/js/109.0e4791e5.js"><link rel="prefetch" href="/assets/js/11.7a5942b2.js"><link rel="prefetch" href="/assets/js/110.c8e27032.js"><link rel="prefetch" href="/assets/js/111.90bb992f.js"><link rel="prefetch" href="/assets/js/112.4709d7c6.js"><link rel="prefetch" href="/assets/js/113.d4ec834f.js"><link rel="prefetch" href="/assets/js/114.d386b164.js"><link rel="prefetch" href="/assets/js/115.aede2aeb.js"><link rel="prefetch" href="/assets/js/116.75026478.js"><link rel="prefetch" href="/assets/js/117.0d8a05db.js"><link rel="prefetch" href="/assets/js/118.3da3c912.js"><link rel="prefetch" href="/assets/js/119.2975d8d8.js"><link rel="prefetch" href="/assets/js/12.869a83d5.js"><link rel="prefetch" href="/assets/js/120.57ea335d.js"><link rel="prefetch" href="/assets/js/121.c880a3b2.js"><link rel="prefetch" href="/assets/js/122.13ff53f3.js"><link rel="prefetch" href="/assets/js/123.787301d8.js"><link rel="prefetch" href="/assets/js/124.8d23f406.js"><link rel="prefetch" href="/assets/js/125.c9b5a4e3.js"><link rel="prefetch" href="/assets/js/126.cb0112f5.js"><link rel="prefetch" href="/assets/js/127.41b23209.js"><link rel="prefetch" href="/assets/js/128.c23f39dd.js"><link rel="prefetch" href="/assets/js/129.10060b72.js"><link rel="prefetch" href="/assets/js/13.33d3c53f.js"><link rel="prefetch" href="/assets/js/130.aa20fc9b.js"><link rel="prefetch" href="/assets/js/131.f6a95dfd.js"><link rel="prefetch" href="/assets/js/132.ab9fc33e.js"><link rel="prefetch" href="/assets/js/133.c4ac141b.js"><link rel="prefetch" href="/assets/js/134.cf0a6733.js"><link rel="prefetch" href="/assets/js/135.26c6340e.js"><link rel="prefetch" href="/assets/js/136.be778fbe.js"><link rel="prefetch" href="/assets/js/137.125de74c.js"><link rel="prefetch" href="/assets/js/138.1e58f9fb.js"><link rel="prefetch" href="/assets/js/14.d15b0afa.js"><link rel="prefetch" href="/assets/js/15.074494e5.js"><link rel="prefetch" href="/assets/js/16.00f79b3e.js"><link rel="prefetch" href="/assets/js/17.f81d5789.js"><link rel="prefetch" href="/assets/js/18.0b390a25.js"><link rel="prefetch" href="/assets/js/19.d5598e67.js"><link rel="prefetch" href="/assets/js/20.14b34ea9.js"><link rel="prefetch" href="/assets/js/21.98281c1b.js"><link rel="prefetch" href="/assets/js/22.db3db27b.js"><link rel="prefetch" href="/assets/js/23.4493258f.js"><link rel="prefetch" href="/assets/js/24.01248968.js"><link rel="prefetch" href="/assets/js/25.d5c285d1.js"><link rel="prefetch" href="/assets/js/26.b1aecfac.js"><link rel="prefetch" href="/assets/js/27.ae9056f2.js"><link rel="prefetch" href="/assets/js/28.6913b540.js"><link rel="prefetch" href="/assets/js/29.1cc25a9b.js"><link rel="prefetch" href="/assets/js/3.c08788cf.js"><link rel="prefetch" href="/assets/js/30.a0597361.js"><link rel="prefetch" href="/assets/js/31.1f336c3b.js"><link rel="prefetch" href="/assets/js/32.6a040528.js"><link rel="prefetch" href="/assets/js/33.8508f937.js"><link rel="prefetch" href="/assets/js/34.e2daff22.js"><link rel="prefetch" href="/assets/js/35.2202edb2.js"><link rel="prefetch" href="/assets/js/36.740f23f1.js"><link rel="prefetch" href="/assets/js/37.d6665061.js"><link rel="prefetch" href="/assets/js/38.9f4aefd4.js"><link rel="prefetch" href="/assets/js/39.6bdd10e7.js"><link rel="prefetch" href="/assets/js/4.31558275.js"><link rel="prefetch" href="/assets/js/40.5debfd5b.js"><link rel="prefetch" href="/assets/js/41.aa210a1b.js"><link rel="prefetch" href="/assets/js/42.67f3cb3a.js"><link rel="prefetch" href="/assets/js/43.574f05b5.js"><link rel="prefetch" href="/assets/js/44.3f56dca2.js"><link rel="prefetch" href="/assets/js/45.15125963.js"><link rel="prefetch" href="/assets/js/46.94f7d800.js"><link rel="prefetch" href="/assets/js/47.86708151.js"><link rel="prefetch" href="/assets/js/48.50c4aac1.js"><link rel="prefetch" href="/assets/js/49.a32d186b.js"><link rel="prefetch" href="/assets/js/5.5873d029.js"><link rel="prefetch" href="/assets/js/50.05d15e12.js"><link rel="prefetch" href="/assets/js/51.8aaa5996.js"><link rel="prefetch" href="/assets/js/52.b416a2d6.js"><link rel="prefetch" href="/assets/js/53.f476d104.js"><link rel="prefetch" href="/assets/js/54.393f5944.js"><link rel="prefetch" href="/assets/js/55.a649f62d.js"><link rel="prefetch" href="/assets/js/56.f0637d2e.js"><link rel="prefetch" href="/assets/js/57.78b570db.js"><link rel="prefetch" href="/assets/js/58.7037b302.js"><link rel="prefetch" href="/assets/js/59.0ead6ebd.js"><link rel="prefetch" href="/assets/js/60.74589ce8.js"><link rel="prefetch" href="/assets/js/61.0e06d52d.js"><link rel="prefetch" href="/assets/js/62.f93dec74.js"><link rel="prefetch" href="/assets/js/63.36eef7bf.js"><link rel="prefetch" href="/assets/js/64.d6c2f4f9.js"><link rel="prefetch" href="/assets/js/66.5a95056c.js"><link rel="prefetch" href="/assets/js/67.3bab79ee.js"><link rel="prefetch" href="/assets/js/68.bf20cda5.js"><link rel="prefetch" href="/assets/js/69.643b734a.js"><link rel="prefetch" href="/assets/js/70.534af764.js"><link rel="prefetch" href="/assets/js/71.6f5d7d49.js"><link rel="prefetch" href="/assets/js/72.a45ee5a1.js"><link rel="prefetch" href="/assets/js/73.7657c2b7.js"><link rel="prefetch" href="/assets/js/74.b9a9aba8.js"><link rel="prefetch" href="/assets/js/75.0b1e276a.js"><link rel="prefetch" href="/assets/js/76.29f04b3c.js"><link rel="prefetch" href="/assets/js/77.9fc64b53.js"><link rel="prefetch" href="/assets/js/78.a2a22fab.js"><link rel="prefetch" href="/assets/js/79.575d2ca2.js"><link rel="prefetch" href="/assets/js/8.11eb4c04.js"><link rel="prefetch" href="/assets/js/80.7c907cad.js"><link rel="prefetch" href="/assets/js/81.9d66ec9e.js"><link rel="prefetch" href="/assets/js/82.65fa1ca8.js"><link rel="prefetch" href="/assets/js/83.e5778419.js"><link rel="prefetch" href="/assets/js/84.ce87e452.js"><link rel="prefetch" href="/assets/js/85.06160d31.js"><link rel="prefetch" href="/assets/js/86.a8aa9f19.js"><link rel="prefetch" href="/assets/js/87.d46b66d7.js"><link rel="prefetch" href="/assets/js/88.4031387e.js"><link rel="prefetch" href="/assets/js/89.23619330.js"><link rel="prefetch" href="/assets/js/9.87cd171b.js"><link rel="prefetch" href="/assets/js/90.bad76de3.js"><link rel="prefetch" href="/assets/js/91.92f6d63b.js"><link rel="prefetch" href="/assets/js/92.0669c06d.js"><link rel="prefetch" href="/assets/js/93.2b829dd2.js"><link rel="prefetch" href="/assets/js/94.e2a63bce.js"><link rel="prefetch" href="/assets/js/95.0a5429c7.js"><link rel="prefetch" href="/assets/js/96.e8368ba6.js"><link rel="prefetch" href="/assets/js/97.3b49c9c4.js"><link rel="prefetch" href="/assets/js/98.029b342f.js"><link rel="prefetch" href="/assets/js/99.2429080e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.853f9491.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d1829642.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><div class="top-nav"><div class="nav-text"></div></div> <header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="UnoPim Documentation" class="logo"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <a href="https://github.com/unopim/unopim" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute to UnoPim
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://unopim.com/en/contacts/" target="_blank" rel="noopener noreferrer" class="nav-item">
    Contact Us
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <div class="nav-item"><select><option value="master">Master</option> <option value="0.1" selected="selected">0.1</option></select></div></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <a href="https://github.com/unopim/unopim" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute to UnoPim
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://unopim.com/en/contacts/" target="_blank" rel="noopener noreferrer" class="nav-item">
    Contact Us
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <div class="nav-item"><select><option value="master">Master</option> <option value="0.1" selected="selected">0.1</option></select></div></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/0.1/prologue" class="sidebar-heading clickable"><span>Prologue</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/0.1/introduction" class="sidebar-heading clickable"><span>Introduction</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/0.1/architecture" class="sidebar-heading clickable"><span>Architecture Overview</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/0.1/packages" class="sidebar-heading clickable router-link-active open"><span>Technical Codebase</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/0.1/packages/create-package.html" class="sidebar-link">Getting Started</a></li><li><a href="/0.1/packages/create-migrations.html" class="sidebar-link">Migrations</a></li><li><a href="/0.1/packages/create-models.html" class="sidebar-link">Models</a></li><li><a href="/0.1/packages/store-data-through-repositories.html" class="sidebar-link">Repositories</a></li><li><a href="/0.1/packages/controllers.html" class="sidebar-link">Controllers</a></li><li><a href="/0.1/packages/routes.html" class="sidebar-link">Routes</a></li><li><a href="/0.1/packages/views.html" class="sidebar-link">Views</a></li><li><a href="/0.1/packages/localization.html" class="sidebar-link">Translations</a></li><li><a href="/0.1/packages/layouts.html" class="sidebar-link">Layouts</a></li><li><a href="/0.1/packages/blade-components.html" class="sidebar-link">Blade Components</a></li><li><a href="/0.1/packages/bundling-assets.html" class="sidebar-link">Bundling Assets</a></li><li><a href="/0.1/packages/add-menu-in-admin.html" class="sidebar-link">Side Menu</a></li><li><a href="/0.1/packages/validation.html" class="sidebar-link">Validation</a></li><li><a href="/0.1/packages/datagrid.html" class="sidebar-link">DataGrid</a></li><li><a href="/0.1/packages/create-acl.html" class="sidebar-link">Access Control List</a></li><li><a href="/0.1/packages/history.html" aria-current="page" class="active sidebar-link">History Tracking</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/0.1/packages/history.html#add-history-to-a-model" class="sidebar-link">Add History to a Model</a></li><li class="sidebar-sub-header"><a href="/0.1/packages/history.html#defining-history-tags" class="sidebar-link">Defining History Tags</a></li><li class="sidebar-sub-header"><a href="/0.1/packages/history.html#customizing-history-fields" class="sidebar-link">Customizing History Fields</a></li><li class="sidebar-sub-header"><a href="/0.1/packages/history.html#displaying-history-in-the-ui" class="sidebar-link">Displaying History in the UI</a></li><li class="sidebar-sub-header"><a href="/0.1/packages/history.html#handling-translatable-fields" class="sidebar-link">Handling Translatable Fields</a></li><li class="sidebar-sub-header"><a href="/0.1/packages/history.html#customizing-history-display-with-presenters" class="sidebar-link">Customizing History Display with Presenters</a></li><li class="sidebar-sub-header"><a href="/0.1/packages/history.html#tracking-history-of-model-relations-via-events" class="sidebar-link">Tracking History of Model Relations via Events</a></li></ul></li><li><a href="/0.1/packages/data-transfer.html" class="sidebar-link">Data Transfer</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/0.1/plugins" class="sidebar-heading clickable"><span>Plugin Development</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/0.1/advanced" class="sidebar-heading clickable"><span>Digging Deeper</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/0.1/api" class="sidebar-heading clickable"><span>Rest APIs</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="history"><a href="#history" class="header-anchor">#</a> History</h1> <p></p><div class="table-of-contents"><ul><li><a href="#add-history-to-a-model">Add History to a Model</a></li><li><a href="#defining-history-tags">Defining History Tags</a><ul><li><a href="#example-for-translations">Example for Translations:</a></li></ul></li><li><a href="#customizing-history-fields">Customizing History Fields</a></li><li><a href="#displaying-history-in-the-ui">Displaying History in the UI</a></li><li><a href="#handling-translatable-fields">Handling Translatable Fields</a></li><li><a href="#customizing-history-display-with-presenters">Customizing History Display with Presenters</a></li><li><a href="#tracking-history-of-model-relations-via-events">Tracking History of Model Relations via Events</a></li></ul></div><p></p> <h2 id="add-history-to-a-model"><a href="#add-history-to-a-model" class="header-anchor">#</a> Add History to a Model</h2> <p>To add history tracking to a model, the model must implement both a <code>History Interface</code> and <code>History Trait</code>.</p> <ul><li><strong>History Interface</strong>: <code>Webkul\HistoryControl\Contracts\HistoryAuditable</code></li> <li><strong>History Trait</strong>: <code>Webkul\HistoryControl\Traits\HistoryTrait</code></li></ul> <h4 id="example"><a href="#example" class="header-anchor">#</a> Example:</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Webkul<span class="token punctuation">\</span>HistoryControl<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>HistoryAuditable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Webkul<span class="token punctuation">\</span>HistoryControl<span class="token punctuation">\</span>Traits<span class="token punctuation">\</span>HistoryTrait</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">AttributeFamily</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token keyword">implements</span> <span class="token class-name">HistoryAuditable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HistoryTrait</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token variable">$historyTags</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'attributeFamily'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="defining-history-tags"><a href="#defining-history-tags" class="header-anchor">#</a> Defining History Tags</h2> <p>The <code>$historyTags</code> property provides a <strong>unique identifier</strong> for a model's history. This tag is primarily used for grouping and displaying the history of related records under a common name (e.g., the history of an entity and its translations).</p> <p>However, to link translations or other related models to their parent entity, we use the <code>getPrimaryModelIdForHistory()</code> function. This function helps identify which parent model the history of a related model (like a translation) belongs to.</p> <h3 id="example-for-translations"><a href="#example-for-translations" class="header-anchor">#</a> Example for Translations:</h3> <p>For an <code>AttributeFamilyTranslation</code> model, both the history tag and the function to link the history to the parent <code>AttributeFamily</code> model are defined as follows:</p> <ol><li><p><strong>History Tag</strong>: Defines the history group label for <code>AttributeFamily</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token variable">$historyTags</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'attributeFamily'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>This ensures the history entries related to this translation will be displayed under the <strong>AttributeFamily</strong> group in the history UI.</li></ul></li> <li><p><strong>Linking Translation to Parent Model</strong>:</p> <p>The <code>getPrimaryModelIdForHistory()</code> function ensures the history of the <code>AttributeFamilyTranslation</code> model is linked to the parent <code>AttributeFamily</code> by returning the foreign key (<code>attribute_family_id</code>).</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getPrimaryModelIdForHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">int</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">attribute_family_id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>This function tells the system that the <code>AttributeFamilyTranslation</code> belongs to the <code>AttributeFamily</code> with the given <code>attribute_family_id</code>.</li></ul></li></ol> <h2 id="customizing-history-fields"><a href="#customizing-history-fields" class="header-anchor">#</a> Customizing History Fields</h2> <p>To control which fields should or should not be tracked in the history, you can use either <code>$auditExclude</code> or <code>$auditInclude</code>.</p> <ul><li><p><strong>Exclude Specific Fields from History</strong>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token variable">$auditExclude</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>Include Only Specific Fields in History</strong>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token variable">$auditInclude</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="displaying-history-in-the-ui"><a href="#displaying-history-in-the-ui" class="header-anchor">#</a> Displaying History in the UI</h2> <p>To display the history of a model, use the following layout in the model's edit page:</p> <div class="language-blade extra-class"><pre class="language-text"><code>&lt;x-admin::layouts.with-history&gt;
    &lt;x-slot:entityName&gt;
        attributeFamily
    &lt;/x-slot&gt;
&lt;/x-admin::layouts.with-history&gt;
</code></pre></div><p>The <code>entityName</code> slot defines the history tag to group the related records.</p> <h2 id="handling-translatable-fields"><a href="#handling-translatable-fields" class="header-anchor">#</a> Handling Translatable Fields</h2> <p>If the model contains translatable fields, you can specify a label for each field to be displayed in the history modal using <code>$historyTranslatableFields</code>.</p> <h4 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example:</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">protected</span> <span class="token variable">$historyTranslatableFields</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'name'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Name'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="customizing-history-display-with-presenters"><a href="#customizing-history-display-with-presenters" class="header-anchor">#</a> Customizing History Display with Presenters</h2> <p>For fields with complex data (like JSON), you can customize how history is presented by implementing the <code>PresentableHistoryInterface</code>.</p> <h4 id="example-3"><a href="#example-3" class="header-anchor">#</a> Example:</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Webkul<span class="token punctuation">\</span>HistoryControl<span class="token punctuation">\</span>Interfaces<span class="token punctuation">\</span>PresentableHistoryInterface</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Product</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token keyword">implements</span> <span class="token class-name">PresentableHistoryInterface</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">getPresenters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'values'</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">ProductValuesPresenter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p><strong>Creating a Custom Presenter</strong>:</p> <p>To create a custom presenter, implement the <code>HistoryPresenterInterface</code> and define how the values should be represented:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Webkul<span class="token punctuation">\</span>HistoryControl<span class="token punctuation">\</span>Interfaces<span class="token punctuation">\</span>HistoryPresenterInterface</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ProductValuesPresenter</span> <span class="token keyword">implements</span> <span class="token class-name">HistoryPresenterInterface</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">representValueForHistory</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Format value as needed for the UI</span>
        <span class="token keyword">return</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token constant">JSON_PRETTY_PRINT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <p>This custom presenter will format the <code>values</code> column data before displaying it in the history modal.</p> <h2 id="tracking-history-of-model-relations-via-events"><a href="#tracking-history-of-model-relations-via-events" class="header-anchor">#</a> Tracking History of Model Relations via Events</h2> <p>In cases where you need to track the history of a related model, you can use an event to dispatch the old and new values of the relation.</p> <p>To dispatch the event, retrieve the old and new values of the relation and pass them along with the model.</p> <h4 id="example-4"><a href="#example-4" class="header-anchor">#</a> Example:</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Event</span><span class="token punctuation">;</span>

<span class="token variable">$oldCurrencies</span> <span class="token operator">=</span> <span class="token variable">$channel</span><span class="token operator">-&gt;</span><span class="token function">currencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$newCurrencies</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'currencies'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Dispatch event with old and new values of the relation</span>
<span class="token class-name static-context">Event</span><span class="token operator">::</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'core.model.proxy.sync.currencies'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'old_values'</span> <span class="token operator">=&gt;</span> <span class="token variable">$oldCurrencies</span><span class="token punctuation">,</span> 
    <span class="token string single-quoted-string">'new_values'</span> <span class="token operator">=&gt;</span> <span class="token variable">$newCurrencies</span><span class="token punctuation">,</span> 
    <span class="token string single-quoted-string">'model'</span> <span class="token operator">=&gt;</span> <span class="token variable">$channel</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In this example:</p> <ul><li><code>$oldCurrencies</code> holds the previous values for the <code>currencies</code> relation.</li> <li><code>$newCurrencies</code> contains the updated values from the request.</li> <li>The <code>Event::dispatch()</code> method is used to trigger the event and pass both the old and new values, along with the related model (<code>$channel</code> in this case).</li></ul> <p>This can then be used to log and display the changes made to the relation, adding detailed history tracking.</p> <p>Make sure you have listeners for the dispatched events to process and store this history, or you can use it in your custom logic to display the difference in the model’s history.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/unopim/unopim-docs/edit/main/docs/0.1/packages/history.md" target="_blank" rel="noopener noreferrer">Help us improve this page on Github.</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/8/2024, 2:05:42 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/0.1/packages/create-acl.html" class="prev">
        Access Control List
      </a></span> <span class="next"><a href="/0.1/packages/data-transfer.html">
        Data Transfer
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.6d62f337.js" defer></script><script src="/assets/js/2.466c6646.js" defer></script><script src="/assets/js/1.4723c82d.js" defer></script><script src="/assets/js/65.0ccd7b6d.js" defer></script>
  </body>
</html>
